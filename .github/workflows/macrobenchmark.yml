name: macrobenchmark

on:
  push:
    branches: [ "master", "develop" ]
  pull_request:
    branches: [ "master", "develop" ]

jobs:
  macrobenchmark:
      runs-on: ubuntu-latest
      steps:
        - uses: actions/checkout@v3
        - name: Grant execute permission for gradlew
          run: chmod +x gradlew
        - name: Build with Gradle
          run: ./gradlew build
        - name: Build app and test app
          run: ./gradlew app:assembleRelease benchmark:assemble
        - name: Download Json File
          run: find benchmark/build/outputs/connected_android_test_additional_output  -name "*.json"
        - name: evaluate benchmark
          run: node scripts/eval_startup_benchmark_output.js
